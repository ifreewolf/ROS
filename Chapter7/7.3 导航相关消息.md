# 7.3 导航相关消息

在导航功能包集中包含了诸多节点，毋庸置疑的，不同节点之间的通信使用到了消息中间件(数据载体)，在上一节的实现中，这些消息已经在rviz中做了可视化处理，比如：地图、雷达、摄像头、里程计、路径规划...的相关消息在rviz中提供了相关组件，本节主要介绍这些消息的具体格式。

## 7.3.1 导航之地图

地图相关的消息主要有两个：

nav_msgs/MapMetaData
- 地图元数据，包括地图的宽度、高度、分辨率等。

nav_msgs/OccupancyGrid
- 地图栅格数据，一般会在rviz中以图形化的方式显示。

### 1. nav_msgs/MapMetaData

调用`rosmsg info nav_msgs/MapMetaData`显示消息内容如下：

```yaml
time map_load_time
float32 resolution
uint32 width
uint32 height
geometry_msgs/Pose origin
  geometry_msgs/Point position
    float64 x
    float64 y
    float64 z
  geometry_msgs/Quaternion orientation
    float64 x
    float64 y
    float64 z
    float64 w
```

### 2. nav_msgs/OccupancyGrid

调用`rosmsg info nav_msgs/OccupancyGrid`显示消息内容如下：

```yaml
std_msgs/Header header
  uint32 seq
  time stamp
  string frame_id
nav_msgs/MapMetaData info
  time map_load_time
  float32 resolution
  uint32 width
  uint32 height
  geometry_msgs/Pose origin
    geometry_msgs/Point position
      float64 x
      float64 y
      float64 z
    geometry_msgs/Quaternion orientation
      float64 x
      float64 y
      float64 z
      float64 w
int8[] data
```

## 7.3.2 导航之里程计

里程计相关消息是：nav_msgs/Odometry，调用`rosmsg info nav_msgs/Odometry`显示消息内容如下：

```yaml
std_msgs/Header header
  uint32 seq
  time stamp
  string frame_id
string child_frame_id
geometry_msgs/PoseWithCovariance pose
  geometry_msgs/Pose pose
    geometry_msgs/Point position
      float64 x
      float64 y
      float64 z
    geometry_msgs/Quaternion orientation
      float64 x
      float64 y
      float64 z
      float64 w
  float64[36] covariance
geometry_msgs/TwistWithCovariance twist
  geometry_msgs/Twist twist
    geometry_msgs/Vector3 linear
      float64 x
      float64 y
      float64 z
    geometry_msgs/Vector3 angular
      float64 x
      float64 y
      float64 z
  float64[36] covariance
```

## 7.3.3 导航之坐标变换

坐标变换相关消息是：tf/tfMessage，调用`rosmsg info tf/tfMessage`显示消息内容如下：

```yaml
geometry_msgs/TransformStamped[] transforms
  std_msgs/Header header
    uint32 seq
    time stamp
    string frame_id
  string child_frame_id
  geometry_msgs/Transform transform
    geometry_msgs/Vector3 translation
      float64 x
      float64 y
      float64 z
    geometry_msgs/Quaternion rotation
      float64 x
      float64 y
      float64 z
      float64 w
```

## 7.3.4 导航之定位

定位相关消息是：geometry_msgs/PoseArray，调用`rosmsg info geometry_msgs/PoseArray`显示消息内容如下：

```yaml
std_msgs/Header header
  uint32 seq
  time stamp
  string frame_id
geometry_msgs/Pose[] poses
  geometry_msgs/Point position
    float64 x
    float64 y
    float64 z
  geometry_msgs/Quaternion orientation
    float64 x
    float64 y
    float64 z
    float64 w
```

## 7.3.5 导航之目标点与路径规划

目标点相关消息是：move_base_msgs/MoveBaseActionGoal，调用`rosmsg info move_base_msgs/MoveBaseActionGoal`显示消息内容如下：

```yaml
std_msgs/Header header
  uint32 seq
  time stamp
  string frame_id
actionlib_msgs/GoalID goal_id
  time stamp
  string id
move_base_msgs/MoveBaseGoal goal
  geometry_msgs/PoseStamped target_pose
    std_msgs/Header header
      uint32 seq
      time stamp
      string frame_id
    geometry_msgs/Pose pose
      geometry_msgs/Point position
        float64 x
        float64 y
        float64 z
      geometry_msgs/Quaternion orientation
        float64 x
        float64 y
        float64 z
        float64 w
```

路径规划相关消息是：nav_msgs/Path，调用`rosmsg info nav_msgs/Path`显示消息内容如下：

```yaml
std_msgs/Header header
  uint32 seq
  time stamp
  string frame_id
geometry_msgs/PoseStamped[] poses
  std_msgs/Header header
    uint32 seq
    time stamp
    string frame_id
  geometry_msgs/Pose pose
    geometry_msgs/Point position
      float64 x
      float64 y
      float64 z
    geometry_msgs/Quaternion orientation
      float64 x
      float64 y
      float64 z
      float64 w
```

## 7.3.6 导航之激光雷达

激光雷达相关消息是：sensor_msgs/LaserScan，调用`rosmsg info sensor_msgs/LaserScan`显示消息内容如下：

```yaml
std_msgs/Header header
  uint32 seq
  time stamp
  string frame_id
float32 angle_min
float32 angle_max
float32 angle_increment
float32 time_increment
float32 scan_time
float32 range_min
float32 range_max
float32[] ranges
float32[] intensities
```

## 7.3.7 导航之相机

深度相机相关消息有：sensor_msgs/Image、sensor_msgs/CompressedImage、sensor_msgs/PointCloud2。sensor_msgs/Image对应的一般的图像数据，sensor_msgs/CompressedImage对应压缩后的图像数据，sensor_msgs/PointCloud2对应的是点云数据(带有深度信息的图像数据)。

调用`rosmsg info sensor_msgs/Image`显示消息内容如下：

```yaml
std_msgs/Header header
  uint32 seq
  time stamp
  string frame_id
uint32 height
uint32 width
string encoding
uint8 is_bigendian
uint32 step
uint8[] data
```

调用`rosmsg info sensor_msgs/CompressedImage`显示消息内容如下：

```yaml
std_msgs/Header header
  uint32 seq
  time stamp
  string frame_id
string format
uint8[] data
```

调用`rosmsg info sensor_msgs/PointCloud2`显示消息内容如下：

```yaml
std_msgs/Header header
  uint32 seq
  time stamp
  string frame_id
uint32 height
uint32 width
sensor_msgs/PointField[] fields
  uint8 INT8=1
  uint8 UINT8=2
  uint8 INT16=3
  uint8 UINT16=4
  uint8 INT32=5
  uint8 UINT32=6
  uint8 FLOAT32=7
  uint8 FLOAT64=8
  string name
  uint32 offset
  uint8 datatype
  uint32 count
bool is_bigendian
uint32 point_step
uint32 row_step
uint8[] data
bool is_dense
```

## 7.3.8 深度图像转激光数据

本届介绍ROS中的一个功能包：depthimage_to_laserscan，顾名思义，该功能包可以将深度图像信息转换成激光雷达信息，应用场景如下：

> 在诸多SLAM算法中，一般都需要订阅激光雷达数据用于构建地图，因为激光雷达可以感知周围环境的深度信息，而深度相机也具备感知深度信息的功能，且最初激光雷达价格比较昂贵，那么在传感器选型上可以选用深度相机代替激光雷达吗？

答案是可以的，不过二者发布的消息类型是完全不同的，如果想要实现传感器的置换，那么就需要将深度相机发布的三维的图形信息转换成二维的激光雷达信息，这一功能就是通过depthimage_to_laserscan来实现的。

### 1. depthimage_to_laserscan简介

#### 1.1 原理